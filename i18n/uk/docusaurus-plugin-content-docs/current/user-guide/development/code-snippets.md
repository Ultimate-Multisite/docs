---
title: Фрагменти коду
sidebar_position: 1
_i18n_hash: 2284b14474d86f665fa7c84cc305553e
---
# Фрагменти коду для v2

Фрагменти коду для **WordPress** використовують для виконання певних дій, які інакше потребували б окремого невеликого плагіна. Такі фрагменти коду розміщують в одному з основних файлів WordPress або теми (зазвичай у файлі functions.php вашої теми), або їх можна використовувати як MU-плагін.

У цій статті ми покажемо три фрагменти коду, які можна використовувати з **Ultimate Multisite v2**:

  * [**Зміна позиції пункту меню «Обліковий запис»**](#changing-the-position-of-the-account-menu-item)

  * [**Як перевірити, чи користувач підключений до певного плану та/або має активну підписку**](#how-to-check-if-the-user-is-under-a-given-plan-andor-has-an-active-subscription)

  * [**Виправлення проблем CORS із шрифтовими іконками на прив'язаних доменах**](#fixing-cors-issues-with-font-icons-in-mapped-domains)

## Зміна позиції пункту меню «Обліковий запис»

Щоб змінити позицію пункту меню «Обліковий запис» на Консолі вашого клієнта, просто додайте наступний фрагмент коду до файлу functions.php активної теми вашого головного сайту. Також можна розмістити цей фрагмент в одному з ваших mu-plugins або власних плагінів.

add_filter('wu_my_account_menu_position', function() { return 10; // Змініть це значення, щоб розмістити меню в потрібній позиції.

## Як перевірити, чи користувач підключений до певного плану та/або має активну підписку

Як адміністратор мережі, вам може знадобитися створити власні функції, які виконуватимуть базові дії або надаватимуть доступ до сервісу/функції обраній групі підписників чи кінцевих користувачів на основі статусу їхньої підписки та плану, до якого вони підключені.

Ці вбудовані функції Ultimate Multisite допоможуть вам у цьому.

Щоб перевірити, чи є користувач учасником певного плану, можна використати функцію:

wu_has_plan($user_id, $plan_id)

Щоб перевірити, чи підписка активна, можна використати функцію:

wu_is_active_subscriber($user_id)

Нижче наведено приклад фрагмента коду, який перевіряє, чи поточний користувач підключений до певного плану (_ID плану 50_) і чи його підписка активна.

$user_id = get_current_user_id();$plan_id = 50;if (wu_has_plan($user_id, $plan_id) && wu_is_active_subscriber($user_id)) { // КОРИСТУВАЧ Є УЧАСНИКОМ ПЛАНУ І ЙОГО ПІДПИСКА АКТИВНА, ВИКОНУЄМО ДІЇ} else { // КОРИСТУВАЧ НЕ Є УЧАСНИКОМ ПЛАНУ -- АБО -- ЙОГО ПІДПИСКА НЕ АКТИВНА, ВИКОНУЄМО ІНШІ ДІЇ} // end if;

Зверніть увагу, що _**wu_has_plan**_ потребує «ID плану» для коректної роботи.

Щоб отримати ID плану, перейдіть до **Ultimate Multisite > Products**. ID кожного продукту відображається праворуч у таблиці.

Зверніть увагу, що користувачі можуть бути підписані лише на **План**, а не на Package чи Service, оскільки вони є лише доповненнями до **Плану**.

![Список продуктів з ID планів](/img/admin/products-list.png)

## Виправлення проблем CORS із шрифтовими іконками на прив'язаних доменах
## Виправлення проблем CORS із шрифтовими іконками на прив'язаних доменах

Після прив'язки домену до підсайту ви можете виявити, що сайт має проблеми із завантаженням власних шрифтів. Це спричинено блокуванням крос-доменних запитів у налаштуваннях вашого сервера.

Оскільки файли шрифтів майже завжди завантажуються безпосередньо з CSS, наш плагін прив'язки доменів не може переписати URL-адреси для використання прив'язаного домену замість оригінального, тому для вирішення проблеми вам потрібно внести зміни до конфігураційних файлів сервера.

Нижче наведено фрагменти коду для виправлення проблеми на Apache та NGINX. Ці зміни потребують поглиблених знань конфігураційних файлів сервера (файли .htaccess та конфігураційні файли NGINX). Якщо вам незручно вносити ці зміни самостійно, надішліть цю сторінку службі підтримки вашого хостинг-провайдера, коли звертатиметеся за допомогою.

### Apache

У вашому файлі .htaccess додайте:

<FilesMatch ".(ttf|ttc|otf|eot|woff|font.css|css)$"> Header set Access-Control-Allow-Origin "*" 

### NGINX

У вашому конфігураційному файлі сервера (розташування залежить від сервера) додайте:

location ~ .(ttf|ttc|otf|eot|woff|font.css|css)$ { add_header Access-Control-Allow-Origin "*";}
