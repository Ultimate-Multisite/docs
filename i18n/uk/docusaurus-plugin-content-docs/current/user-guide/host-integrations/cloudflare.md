---
title: Інтеграція з Cloudflare
sidebar_position: 16
_i18n_hash: 41bd975db7c89a129f5f880b439a8f2f
---
# Інтеграція з Cloudflare

## Огляд
Cloudflare — це провідна мережа доставки контенту (CDN) і постачальник безпекових рішень, який допомагає захищати та прискорювати веб-сайти. Ця інтеграція дає змогу автоматично керувати доменами між Ultimate Multisite і Cloudflare, особливо для мультисайтових установок на субдоменах.

## Можливості
- Автоматичне створення субдоменів у Cloudflare
- Підтримка проксованих субдоменів
- Керування DNS-записами
- Покращене відображення DNS-записів в адмінці Ultimate Multisite

## Вимоги
У файлі `wp-config.php` потрібно визначити такі константи:

```php
define('WU_CLOUDFLARE_API_KEY', 'your_api_key');
define('WU_CLOUDFLARE_ZONE_ID', 'your_zone_id');
```

## Інструкція з налаштування

### 1. Отримайте API-ключ Cloudflare

1. Увійдіть у панель керування Cloudflare
2. Перейдіть до «My Profile» (натисніть на свою електронну адресу у верхньому правому куті)
3. Оберіть «API Tokens» у меню
4. Створіть новий API-токен із такими дозволами:
   - Zone.Zone: Read
   - Zone.DNS: Edit
5. Скопіюйте свій API-токен

### 2. Отримайте Zone ID

1. У панелі керування Cloudflare оберіть домен, який хочете використовувати
2. Zone ID відображається на вкладці «Overview» у правій бічній панелі в розділі «API»
3. Скопіюйте Zone ID

### 3. Додайте константи до wp-config.php

Додайте такі константи до файлу `wp-config.php`:

```php
define('WU_CLOUDFLARE_API_KEY', 'your_api_token');
define('WU_CLOUDFLARE_ZONE_ID', 'your_zone_id');
```

### 4. Увімкніть інтеграцію

1. В адмінці WordPress перейдіть до Ultimate Multisite > Settings
2. Відкрийте вкладку «Domain Mapping»
3. Прокрутіть вниз до «Host Integrations»
4. Увімкніть інтеграцію з Cloudflare
5. Натисніть «Save Changes»

## Як це працює

### Керування субдоменами

Коли створюється новий сайт у мультисайтовій установці на субдоменах:

1. Інтеграція надсилає запит до API Cloudflare для додавання CNAME-запису для субдомену
2. Субдомен за замовчуванням налаштовується на проксування через Cloudflare (це можна змінити за допомогою фільтрів)
3. Коли сайт видаляється, інтеграція видаляє субдомен із Cloudflare

### Відображення DNS-записів

Інтеграція покращує відображення DNS-записів в адмінці Ultimate Multisite таким чином:

1. Отримує DNS-записи безпосередньо з Cloudflare
2. Показує, чи записи проксовані
3. Відображає додаткову інформацію про DNS-записи

## Важливо знати

Згідно з останніми оновленнями Cloudflare, проксування wildcard-записів тепер доступне для всіх клієнтів. Це означає, що інтеграція з Cloudflare стала менш критичною для мультисайтових установок на субдоменах, ніж раніше, оскільки ви можете просто налаштувати wildcard DNS-запис у Cloudflare.

## Усунення неполадок

### Проблеми з підключенням до API
- Переконайтеся, що ваш API-токен правильний і має необхідні дозволи
- Перевірте, чи Zone ID вказано правильно
- Переконайтеся, що ваш обліковий запис Cloudflare має потрібні права доступу

### Субдомен не додається
- Перевірте логи Ultimate Multisite на наявність повідомлень про помилки
- Переконайтеся, що субдомен ще не додано до Cloudflare
- Перевірте, чи ваш тарифний план Cloudflare підтримує потрібну кількість DNS-записів

### Проблеми з проксуванням
- Якщо ви не хочете, щоб субдомени проксувалися, використовуйте фільтр `wu_cloudflare_should_proxy`
- Деякі функції можуть працювати некоректно при проксуванні (наприклад, певні функції адмінки WordPress)
- Розгляньте можливість використання Page Rules у Cloudflare для обходу кешу на сторінках адмінки
