---
title: ตัวช่วยตั้งค่าเครือข่ายหลายไซต์
sidebar_position: 3
_i18n_hash: fd09dc94f24b0b37245b847380feea3f
---
# วิซาร์ดตั้งค่า Multisite

Ultimate Multisite มีวิซาร์ดในตัวที่แปลงการติดตั้ง WordPress แบบมาตรฐานให้เป็นเครือข่าย WordPress Multisite โดยอัตโนมัติ ช่วยให้คุณไม่ต้องแก้ไขไฟล์ `wp-config.php` หรือรันคำสั่งฐานข้อมูลด้วยตัวเอง

:::tip
หากการติดตั้ง WordPress ของคุณทำงานเป็นเครือข่าย Multisite อยู่แล้ว คุณสามารถข้ามขั้นตอนนี้ได้เลย วิซาร์ดจะปรากฏเฉพาะเมื่อยังไม่ได้เปิดใช้งาน Multisite เท่านั้น
:::

## วิซาร์ดจะปรากฏเมื่อใด?

เมื่อคุณเปิดใช้งาน Ultimate Multisite บนการติดตั้ง WordPress แบบมาตรฐาน (ที่ไม่ใช่ Multisite) plugin จะตรวจพบว่า Multisite ยังไม่ได้เปิดใช้งาน และจะนำคุณไปยังวิซาร์ดตั้งค่า Multisite โดยอัตโนมัติ แทนที่จะเป็นวิซาร์ดตั้งค่าปกติ

คุณยังสามารถเข้าถึงได้โดยตรงที่ **WP Admin > Ultimate Multisite > Multisite Setup**

## ข้อกำหนดเบื้องต้น

ก่อนรันวิซาร์ด โปรดตรวจสอบให้แน่ใจว่า:

- คุณมี**สิทธิ์ผู้ดูแลระบบ**ในการติดตั้ง WordPress ของคุณ
- ไฟล์ `wp-config.php` ของเซิร์ฟเวอร์**สามารถเขียนได้**โดยเว็บเซิร์ฟเวอร์
- คุณมี**ข้อมูลสำรองล่าสุด**ของไฟล์และฐานข้อมูล

:::warning
วิซาร์ดจะแก้ไขไฟล์ `wp-config.php` และสร้างตารางฐานข้อมูลใหม่ ควรสำรองข้อมูลก่อนดำเนินการเสมอ
:::

## ขั้นตอนที่ 1: ยินดีต้อนรับ

หน้าจอแรกจะอธิบายว่า WordPress Multisite คืออะไร และวิซาร์ดจะทำอะไรบ้าง:

- เปิดใช้งานฟีเจอร์ Multisite ในการตั้งค่า WordPress ของคุณ
- สร้างตารางฐานข้อมูลเครือข่ายที่จำเป็น
- เพิ่ม multisite constants ที่จำเป็นลงใน `wp-config.php`
- เปิดใช้งาน Ultimate Multisite ทั่วทั้งเครือข่าย (Network-activate)

![Multisite Setup Wizard - Welcome step](/img/installation/multisite-wizard/wizard-welcome.png)

คลิก **Continue** เพื่อดำเนินการต่อ

## ขั้นตอนที่ 2: การตั้งค่าเครือข่าย

ขั้นตอนนี้จะให้คุณกำหนดการตั้งค่าเครือข่ายของคุณ

### โครงสร้างเว็บไซต์

เลือกวิธีการจัดระเบียบเว็บไซต์ในเครือข่ายของคุณ:

- **Sub-domains** (แนะนำ) — เว็บไซต์จะได้รับ subdomain ของตัวเอง เช่น `site1.yourdomain.com`
- **Sub-directories** — เว็บไซต์จะถูกสร้างเป็น path เช่น `yourdomain.com/site1`

:::note
หากคุณเลือก sub-domains คุณจะต้องตั้งค่า **wildcard DNS** และ **wildcard SSL certificate** สำหรับโดเมนของคุณ โฮสต์ WordPress แบบ managed ส่วนใหญ่จะจัดการเรื่องนี้ให้โดยอัตโนมัติ ดู [Ultimate Multisite 101](./ultimate-multisite-101) สำหรับการเปรียบเทียบโดยละเอียด
:::

### ชื่อเครือข่าย

ใส่ชื่อสำหรับเครือข่ายของคุณ ค่าเริ่มต้นจะเป็นชื่อเว็บไซต์ปัจจุบันของคุณต่อท้ายด้วย "Network" คุณสามารถเปลี่ยนแปลงได้ภายหลังจากการตั้งค่าเครือข่าย

### อีเมลผู้ดูแลเครือข่าย

ที่อยู่อีเมลที่ใช้สำหรับการแจ้งเตือนการดูแลเครือข่าย ค่าเริ่มต้นจะเป็นที่อยู่อีเมลของผู้ใช้ปัจจุบัน

![Multisite Setup Wizard - Network Configuration](/img/installation/multisite-wizard/wizard-network-configuration.png)

หลังจากกรอกข้อมูลครบแล้ว คลิก **Continue** เพื่อดำเนินการต่อ

## ขั้นตอนที่ 3: การติดตั้ง

คลิกปุ่ม **Install** เพื่อเริ่มต้น วิซาร์ดจะดำเนินการ 5 ขั้นตอนอัตโนมัติตามลำดับ โดยแสดงความคืบหน้าแบบเรียลไทม์:

![Multisite Setup Wizard - Installation pending](/img/installation/multisite-wizard/wizard-installation-pending.png)

| ขั้นตอน | คำอธิบาย |
|------|-------------|
| **Enable Multisite** | เพิ่ม constant `WP_ALLOW_MULTISITE` ลงใน `wp-config.php` |
| **Create Network** | สร้างตารางฐานข้อมูล multisite (`wp_site`, `wp_sitemeta`, `wp_blogs` ฯลฯ) และใส่ข้อมูลการตั้งค่าเครือข่ายของคุณ |
| **Update Configuration** | เพิ่ม multisite constants สุดท้ายลงใน `wp-config.php` (`MULTISITE`, `SUBDOMAIN_INSTALL`, `DOMAIN_CURRENT_SITE` ฯลฯ) |
| **Fix Cookies** | ตรวจสอบว่า URL ของเว็บไซต์ถูกต้องใน network metadata เพื่อป้องกันปัญหาการยืนยันตัวตนหลังจากเปิดใช้งาน |
| **Network Activate Plugin** | เปิดใช้งาน Ultimate Multisite ทั่วทั้งเครือข่าย เพื่อให้ทำงานครอบคลุมทั้งเครือข่าย |

แต่ละขั้นตอนจะแสดงสถานะอย่างใดอย่างหนึ่งต่อไปนี้:

- **Pending** — รอดำเนินการ
- **Installing...** — กำลังทำงาน
- **Success!** — เสร็จสมบูรณ์
- **ข้อความแสดงข้อผิดพลาด** — เกิดข้อผิดพลาด (ข้อความจะอธิบายปัญหา)

เมื่อทุกขั้นตอนเสร็จสมบูรณ์ คุณจะเห็นสถานะ "Success!" สีเขียวสำหรับแต่ละรายการ:

![Multisite Setup Wizard - Installation complete](/img/installation/multisite-wizard/wizard-installation-complete.png)

จากนั้นวิซาร์ดจะดำเนินการไปยังหน้าจอเสร็จสมบูรณ์โดยอัตโนมัติ

## ขั้นตอนที่ 4: เสร็จสมบูรณ์

เมื่อการติดตั้งเสร็จสมบูรณ์ คุณจะเห็นข้อความยืนยันว่า WordPress Multisite ได้ถูกเปิดใช้งานแล้ว

![Multisite Setup Wizard - Setup Complete](/img/installation/multisite-wizard/wizard-complete.png)

ตอนนี้คุณสามารถดำเนินการต่อกับวิซาร์ดตั้งค่า Ultimate Multisite เพื่อกำหนดค่าแพลตฟอร์ม WaaS ของคุณ (รายละเอียดบริษัท, เนื้อหาเริ่มต้น, payment gateways ฯลฯ)

:::note
หลังจากการติดตั้ง multisite เสร็จสมบูรณ์ เบราว์เซอร์ของคุณจะ redirect ผ่าน network admin ที่เพิ่งเปิดใช้งาน คุณอาจต้องเข้าสู่ระบบอีกครั้งเนื่องจาก authentication cookies ถูกอัปเดตสำหรับสภาพแวดล้อม multisite
:::

## การตั้งค่าด้วยตนเองสำรอง

หากวิซาร์ดไม่สามารถเขียนลงไฟล์ `wp-config.php` ของคุณได้ (เนื่องจากสิทธิ์ไฟล์หรือข้อจำกัดของเซิร์ฟเวอร์) วิซาร์ดจะแสดงโค้ดที่คุณต้องเพิ่มด้วยตนเอง:

1. **wp-config.php constants** ที่ต้องเพิ่มไว้เหนือบรรทัด `/* That's all, stop editing! */`
2. **กฎ .htaccess rewrite** ที่เหมาะสมกับโครงสร้างเว็บไซต์ที่คุณเลือก (subdomain หรือ subdirectory)

หลังจากทำการเปลี่ยนแปลงด้วยตนเองแล้ว รีเฟรชหน้าและวิซาร์ดจะตรวจพบว่า multisite ได้ถูกเปิดใช้งานแล้ว

## การแก้ไขปัญหา

### วิซาร์ดแจ้งว่า wp-config.php ไม่สามารถเขียนได้

กระบวนการเว็บเซิร์ฟเวอร์ของคุณต้องมีสิทธิ์เขียนไฟล์ `wp-config.php` คุณสามารถ:

- เปลี่ยนสิทธิ์ไฟล์ชั่วคราวเป็น `644` หรือ `666`
- ใช้คำแนะนำการตั้งค่าด้วยตนเองสำรองที่วิซาร์ดให้มา
- ขอความช่วยเหลือจากผู้ให้บริการโฮสติ้งของคุณ

### เข้าถึงเว็บไซต์ไม่ได้หลังจากตั้งค่า (subdomains)

หากคุณเลือกโครงสร้าง subdomain คุณต้องตั้งค่า **wildcard DNS** สำหรับโดเมนของคุณ เพิ่ม DNS record:

```
Type: A (or CNAME)
Host: *
Value: [your server IP]
```

สอบถามผู้ให้บริการโฮสติ้งของคุณหากคุณไม่แน่ใจว่าจะตั้งค่าอย่างไร

### ปัญหาการยืนยันตัวตนหลังจากตั้งค่า

หากคุณถูกล็อกเอาต์หรือพบข้อผิดพลาดเกี่ยวกับ cookie หลังจากตั้งค่า multisite:

1. ล้าง browser cookies สำหรับเว็บไซต์
2. เข้าสู่ระบบอีกครั้งที่ `yourdomain.com/wp-login.php`
3. หากปัญหายังคงอยู่ ให้ตรวจสอบว่า `wp-config.php` ของคุณไม่ได้ตั้งค่า `COOKIE_DOMAIN` เป็น `false` — นี่เป็นปัญหาที่ทราบกันในการติดตั้ง multisite แบบ subdomain

### ขั้นตอนหนึ่งล้มเหลวระหว่างการติดตั้ง

หากขั้นตอนการติดตั้งขั้นตอนใดแสดงข้อผิดพลาด:

1. จดข้อความแสดงข้อผิดพลาดที่ปรากฏ
2. กลับไปยังขั้นตอนการตั้งค่าและลองอีกครั้ง
3. หากข้อผิดพลาดยังคงอยู่ ให้ตรวจสอบ PHP error log ของเซิร์ฟเวอร์สำหรับรายละเอียดเพิ่มเติม
4. ขั้นตอนที่เสร็จสมบูรณ์แล้วจะถูกข้ามในการรันครั้งถัดไป (ตัวติดตั้งเป็นแบบ idempotent)
