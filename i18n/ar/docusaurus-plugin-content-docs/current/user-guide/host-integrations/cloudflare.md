---
title: تكامل Cloudflare
sidebar_position: 16
_i18n_hash: 41bd975db7c89a129f5f880b439a8f2f
---
# تكامل Cloudflare

## نظرة عامة
Cloudflare هو شبكة توصيل محتوى (CDN) ومزود أمان رائد يساعد في حماية وتسريع المواقع الإلكترونية. يتيح هذا التكامل إدارة النطاقات تلقائيًا بين Ultimate Multisite و Cloudflare، خاصةً لتثبيتات المتعدد المواقع الفرعية.

## الميزات
- إنشاء نطاق فرعي تلقائي في Cloudflare
- دعم النطاق الفرعي الممرّر
- إدارة سجلات DNS
- عرض سجلات DNS المحسّن في لوحة Ultimate Multisite

## المتطلبات
يجب تعريف الثوابت التالية في ملف `wp-config.php` الخاص بك:

```php
define('WU_CLOUDFLARE_API_KEY', 'your_api_key');
define('WU_CLOUDFLARE_ZONE_ID', 'your_zone_id');
```

## تعليمات الإعداد

### 1. الحصول على رمز API الخاص بـ Cloudflare

1. سجّل الدخول إلى لوحة تحكم Cloudflare
2. انتقل إلى "ملفي الشخصي" (انقر على بريدك الإلكتروني في الزاوية اليمنى العليا)
3. اختر "رموز API" من القائمة
4. أنشئ رمز API جديدًا مع الأذونات التالية:
   - Zone.Zone: قراءة
   - Zone.DNS: تعديل
5. انسخ رمز API الخاص بك

### 2. الحصول على معرف المنطقة

1. في لوحة تحكم Cloudflare، اختر النطاق الذي تريد استخدامه
2. يظهر معرف المنطقة (Zone ID) في علامة التبويب "نظرة عامة"، في الشريط الجانبي الأيمن تحت "API"
3. انسخ معرف المنطقة

### 3. إضافة الثوابت إلى wp-config.php

أضف الثوابت التالية إلى ملف `wp-config.php` الخاص بك:

```php
define('WU_CLOUDFLARE_API_KEY', 'your_api_token');
define('WU_CLOUDFLARE_ZONE_ID', 'your_zone_id');
```

### 4. تمكين التكامل

1. في لوحة تحكم WordPress، انتقل إلى Ultimate Multisite > الإعدادات
2. انتقل إلى علامة التبويب "خريطة النطاق"
3. مرر لأسفل إلى "تكامل المضيف"
4. فعّل تكامل Cloudflare
5. انقر على "حفظ التغييرات"

## كيف يعمل

### إدارة النطاق الفرعي

عند إنشاء موقع جديد في تثبيت متعدد المواقع الفرعية:

1. يرسل التكامل طلبًا إلى API Cloudflare لإضافة سجل CNAME للنطاق الفرعي
2. يُكوَّن النطاق الفرعي ليُمرَّر عبر Cloudflare افتراضيًا (يمكن تغييره باستخدام المرشحات)
3. عند حذف موقع، سيزيل التكامل النطاق الفرعي من Cloudflare

### عرض سجل DNS

يعزز التكامل عرض سجلات DNS في لوحة Ultimate Multisite عن طريق:

1. جلب سجلات DNS مباشرةً من Cloudflare
2. عرض ما إذا كانت السجلات مُمرَّرة أم لا
3. عرض معلومات إضافية حول سجلات DNS

## ملاحظات مهمة

اعتبارًا من تحديثات Cloudflare الأخيرة، أصبح التمكين العام للتمرير عبر النطاقات العامة متاحًا لجميع العملاء. هذا يعني أن تكامل Cloudflare أقل أهمية لتثبيتات المتعدد المواقع الفرعية مما كان عليه، حيث يمكنك ببساطة إعداد سجل DNS عام في Cloudflare.

## استكشاف الأخطاء وإصلاحها

### مشاكل اتصال API
- تحقق من أن رمز API الخاص بك صحيح ويملك الأذونات اللازمة
- تحقق من أن معرف المنطقة صحيح
- تأكد من أن حساب Cloudflare الخاص بك يملك الأذونات اللازمة

### عدم إضافة النطاق الفرعي
- تحقق من سجلات Ultimate Multisite لأي رسائل خطأ
- تحقق من أن النطاق الفرعي غير مضاف بالفعل إلى Cloudflare
- تأكد من أن خطة Cloudflare الخاصة بك تدعم عدد سجلات DNS التي تقوم بإنشائها

### مشاكل التمكين
- إذا كنت لا تريد أن تُمرَّر النطاقات الفرعية، يمكنك استخدام مرشح `wu_cloudflare_should_proxy`
- قد لا تعمل بعض الميزات بشكل صحيح عند التمكين (على سبيل المثال، بعض وظائف لوحة WordPress)
- فكر في استخدام قواعد الصفحة (Page Rules) في Cloudflare لتجاوز التخزين المؤقت لصفحات الإدارة
