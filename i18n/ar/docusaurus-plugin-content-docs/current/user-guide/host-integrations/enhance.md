---
title: تحسين تكامل لوحة التحكم
sidebar_position: 2
_i18n_hash: 2b4047e6b7b32a1c96a0b562e251cbfb
---
# تكامل لوحة تحكم Enhance

## نظرة عامة
Enhance هي لوحة تحكم حديثة توفر قدرات أتمتة واستضافة قوية وإدارة. يتيح هذا التكامل مزامنة النطاقات تلقائيًا وإدارة شهادات SSL بين Ultimate Multisite ولوحة تحكم Enhance.

**مناقشة ذات صلة:** راجع [مناقشة GitHub #265](https://github.com/Multisite-Ultimate/ultimate-multisite/discussions/265) للحصول على نصائح المجتمع ومعلومات إضافية.

## الميزات
- المزامنة التلقائية للنطاقات عند تعيينها في Ultimate Multisite
- توفير شهادات SSL تلقائيًا عبر LetsEncrypt عند حل DNS
- دعم النطاقات الفرعية للشبكات التي تعمل في وضع النطاق الفرعي
- إزالة النطاق عند حذف التعيينات
- اختبار الاتصال للتحقق من بيانات اعتماد API

## المتطلبات

### متطلبات النظام
- تثبيت لوحة تحكم Enhance والوصول إليها
- تثبيت WordPress Multisite مستضاف على أو متصل بخادم Enhance
- خادم ويب Apache (دعم Enhance حاليًا لتكوينات Apache؛ LiteSpeed Enterprise متاح بتكلفة مخفضة)

### الوصول إلى API
يجب أن يكون لديك حق وصول المسؤول إلى لوحة تحكم Enhance لإنشاء رموز API.

## الحصول على بيانات اعتماد API الخاصة بك

### 1. إنشاء رمز API

1. سجّل الدخول إلى لوحة تحكم Enhance كمسؤول
2. انقر على **الإعدادات** في قائمة التنقل
3. انتقل إلى **رموز الوصول**
4. انقر على **إنشاء رمز**
5. أعطِ الرمز اسمًا وصفيًا (مثلاً، "تكامل Ultimate Multisite")
6. عين دور **مسؤول النظام**
7. بالنسبة لتاريخ الانتهاء:
   - اتركه فارغًا إذا كنت تريد أن لا ينتهي صلاحية الرمز
   - أو حدد تاريخ انتهاء صلاحية محدد لأغراض الأمان
8. انقر على **إنشاء**

بعد الإنشاء، سيُعرض **رمز الوصول** و**معرف المنظمة**. **احفظهما فورًا** لأن الرمز سيُعرض مرة واحدة فقط.

### 2. الحصول على معرف المنظمة

معرف المنظمة يظهر في صفحة رموز الوصول داخل صندوق معلومات أزرق يحمل عنوان "معرف المنظمة: {your_id}".  
معرف المنظمة هو UUID يُنسق مثل: `d8554b6d-5d0d-6719-009b-fec1189aa8f3`

يمكنك أيضًا العثور على معرف المنظمة للعميل عبر:
1. انتقل إلى صفحة **العملاء**
2. انقر على **إدارة العميل** للعميل المعني
3. انظر إلى عنوان URL - معرف المنظمة هو الأحرف الأبجدية الرقمية بعد `/customers/`

### 3. الحصول على معرف الخادم

للعثور على معرف الخادم (مطلوب لعمليات النطاق):

1. في لوحة تحكم Enhance، انتقل إلى **الخوادم**
2. انقر على الخادم الذي يعمل عليه تثبيت WordPress الخاص بك
3. سيُظهر معرف الخادم (بصيغة UUID) في عنوان URL أو تفاصيل الخادم
4. بدلاً من ذلك، يمكنك استخدام API لعرض الخوادم:

```bash
curl -s -X GET https://your-enhance-panel.com/api/servers \
  -H "Accept: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" | jq
```

يتبع معرف الخادم صيغة UUID: `00000000-0000-0000-0000-000000000000`

### 4. الحصول على عنوان URL للـ API

عنوان URL للـ API هو عنوان URL للوحة تحكم Enhance مع إضافة `/api/`:

```
https://your-enhance-panel.com/api/
```

**مهم:** مسار `/api/` مطلوب. الأخطاء الشائعة تشمل:
- استخدام النطاق فقط بدون `/api/`
- استخدام HTTP بدلاً من HTTPS (HTTPS مطلوب للأمان)

## التكوين

### الثوابت المطلوبة

أضف الثوابت التالية إلى ملف `wp-config.php` الخاص بك:

```php
// تكامل لوحة تحكم Enhance
define('WU_ENHANCE_API_TOKEN', 'your-bearer-token-here');
define('WU_ENHANCE_API_URL', 'https://your-enhance-panel.com/api/');
define('WU_ENHANCE_SERVER_ID', 'your-server-uuid-here');
```

### إعداد عبر معالج التكامل

1. في لوحة تحكم WordPress، انتقل إلى **Ultimate Multisite** > **الإعدادات**
2. انتقل إلى علامة التبويب **التكاملات**
3. ابحث عن **تكامل لوحة تحكم Enhance** وانقر على **التكوين**
4. سيرشدك المعالج خلال الإعداد:
   - **الخطوة 1:** مقدمة ونظرة عامة على الميزات
   - **الخطوة 2:** أدخل بيانات اعتماد API الخاصة بك (الرمز، عنوان URL للـ API، معرف الخادم)
   - **الخطوة 3:** اختبار الاتصال
   - **الخطوة 4:** مراجعة وتفعيل

يمكنك اختيار:
- السماح للمعالج بحقن الثوابت في ملف `wp-config.php` تلقائيًا
- نسخ تعريفات الثوابت وإضافتها يدويًا

## تكوين WordPress الإضافي

استنادًا إلى ملاحظات المجتمع ([مناقشة #265](https://github.com/Multisite-Ultimate/ultimate-multisite/discussions/265))، قد تحتاج إلى تكوين الإعدادات التالية:

### تكوين .htaccess

إذا واجهت مشاكل مع تعيين النطاق:
1. احذف ملف `.htaccess` الأصلي لـ Enhance
2. استبدله بملف `.htaccess` القياسي لـ WordPress Multisite

### ثوابت الكوكي

أضف الثوابت التالية إلى `wp-config.php` لضمان معالجة الكوكي بشكل صحيح عبر النطاقات المعيّنة:

```php
define('COOKIE_DOMAIN', $_SERVER['HTTP_HOST']);
define('COOKIEPATH', '/');
define('ADMIN_COOKIE_PATH', '/');
```

## كيف يعمل

### عند تعيين نطاق

1. يعيّن المستخدم نطاقًا مخصصًا في Ultimate Multisite (أو يتم إنشاء موقع جديد في وضع النطاق الفرعي)
2. يرسل التكامل طلب POST إلى API Enhance: `/servers/{server_id}/domains`
3. يضيف Enhance النطاق إلى تكوين الخادم الخاص بك
4. عندما يحل DNS إلى خادمك، يقوم Enhance تلقائيًا بتوفير شهادة SSL عبر LetsEncrypt
5. يصبح النطاق نشطًا مع HTTPS

### عند إزالة نطاق

1. يتم حذف تعيين نطاق في Ultimate Multisite
2. يستعلم التكامل عن معرف النطاق
3. يُرسل طلب DELETE إلى: `/servers/{server_id}/domains/{domain_id}`
4. يزيل Enhance النطاق من تكوين الخادم الخاص بك

### فحص DNS و SSL

يحتوي Ultimate Multisite على فحص DNS و SSL مدمج:
- يمكنك تكوين فترة الفحص في **إعدادات تعيين النطاق** (الافتراضي: 300 ثانية/5 دقائق)
- سيقوم النظام بالتحقق من انتشار DNS قبل وضع النطاق كنشط
- يتم التحقق من صلاحية شهادة SSL تلقائيًا
- يتعامل Enhance مع توفير SSL تلقائيًا، لذلك لا حاجة لتكوين SSL يدويًا

## التحقق من الإعداد

### اختبار الاتصال

1. في معالج التكامل، استخدم خطوة **اختبار الاتصال**
2. سيحاول المكون الإضافي سرد النطاقات على خادمك
3. تؤكد رسالة النجاح:
   - بيانات اعتماد API صحيحة
   - عنوان URL للـ API قابل للوصول
   - معرف الخادم صالح
   - الأذونات مضبوطة بشكل صحيح

### بعد تعيين نطاق

1. عيّن نطاقًا تجريبيًا في Ultimate Multisite
2. تحقق من سجلات Ultimate Multisite (**Ultimate Multisite** > **Logs** > **integration-enhance**)
3. تحقق في لوحة تحكم Enhance أن النطاق تمت إضافته:
   - انتقل إلى **الخوادم** > **خادمك** > **النطاقات**
   - يجب أن يظهر النطاق الجديد في القائمة
4. بمجرد انتشار DNS، تحقق من أن SSL تم توفيره تلقائيًا

## استكشاف الأخطاء وإصلاحها

### مشكلات اتصال API

**خطأ: "فشل الاتصال بواجهة API Enhance"**  
- تحقق من أن `WU_ENHANCE_API_URL` يتضمن `/api/` في النهاية  
- تأكد من أنك تستخدم HTTPS، وليس HTTP  
- تحقق من أن لوحة تحكم Enhance متاحة من خادم WordPress الخاص بك  
- تحقق من عدم وجود قواعد جدار حماية تمنع الاتصال

**خطأ: "لم يتم العثور على رمز API Enhance"**  
- تأكد من أن `WU_ENHANCE_API_TOKEN` معرف في `wp-config.php`  
- تحقق من أن الرمز لم يُحذف أو ينتهي صلاحيته في Enhance  
- تحقق من وجود أخطاء مطبعية في قيمة الرمز

**خطأ: "معرف الخادم غير مُكوَّن"**  
- تأكد من أن `WU_ENHANCE_SERVER_ID` معرف في `wp-config.php`  
- تأكد من أن معرف الخادم بصيغة UUID صالحة  
- تأكد من أن الخادم موجود في لوحة تحكم Enhance

### النطاق غير مضاف

**تحقق من السجلات:**  
1. انتقل إلى **Ultimate Multisite** > **Logs**  
2. فلتر حسب **integration-enhance**  
3. ابحث عن رسائل خطأ تشير إلى المشكلة

**الأسباب الشائعة:**  
- تنسيق اسم نطاق غير صالح  
- النطاق موجود بالفعل في Enhance  
- أذونات API غير كافية (تأكد من أن الرمز لديه دور مسؤول النظام)  
- معرف الخادم لا يتطابق مع الخادم الفعلي في Enhance

### مشاكل شهادة SSL

**SSL غير متوفر:**  
- تحقق من أن DNS يشير إلى عنوان IP الخاص بخادمك  
- تحقق من أن النطاق يُحلّ بشكل صحيح: `nslookup yourdomain.com`  
- يتطلب Enhance أن يحل DNS قبل أن يتم توفير SSL  
- عادةً ما يستغرق توفير SSL 5-10 دقائق بعد انتشار DNS  
- **تحقق** من سجلات لوحة تحكم Enhance للخطأ المتعلق بالـ SSL

**استكشاف الأخطاء اليدوي SSL في Enhance:**  
1. اذهب إلى **الخوادم** > **خادمك** > **النطاقات**  
2. ابحث عن نطاقك وتحقق من حالته SSL  
- **..**  

### فاصل فحص DNS

إذا كانت النطاقات أو شهادات SSL تستغرق وقتًا طويلاً؟  
1. اذهب إلى **Ultimate Multisite** > **Settings** > **Domain Mapping**  
2. ابحث عن إعداد **فاصل فحص DNS**  
3. اضبط من الافتراضي 300 ثانية إلى قيمة أقل (الحد الأدنى: 10 ثوانٍ)  
4. **ملاحظة:** فترات أقل تعني فحصًا أكثر تكرارًا ولكن بزيادة الحمل على الخادم

### أخطاء المصادقة

**أخطاء HTTP 401/403:**  
- أعد إنشاء رمز API في Enhance  
- تحقق من أن الرمز لديه دور مسؤول النظام  
- تحقق من أن **...**  

### تحليل السجلات

تمكين تسجيل مفصل:

```php
// إضافة إلى wp-config.php لأغراض تصحيح الأخطاء المتقدمة
define('WP_DEBUG', true);
define('WP_DEBUG_LOG', true);
```

ثم تحقق من السجلات في:  
- سجلات Ultimate Multisite: **Ultimate Multisite** > **Logs**  
- سجل تصحيح WordPress: `wp-content/debug.log`  
- سجلات لوحة تحكم Enhance: متاحة في واجهة الإدارة الخاصة بـ Enhance

## مرجع API

### المصادقة
جميع طلبات API تستخدم مصادقة Bearer token:

```
Authorization: Bearer YOUR_TOKEN_HERE
```

### النقاط النهائية المشتركة المستخدمة

**قائمة الخوادم:**  
```
GET /servers
```

**قائمة النطاقات على خادم:**  
```
GET /servers/{...}
```

**إضافة نطاق:**  
```
POST /servers/{server_id}/domains
Body: {"domain": "example.com"}
```

**حذف نطاق:**  
```
DELETE /servers/{server_id}/domains/{domain_id}
```

### وثائق API الكاملة
Complete API documentation: [https://apidocs.enhance.com](https://apidocs.enhance.com)

## أفضل الممارسات

### الأمان
- **لا تقم أبداً بارتكاب** (Never commit API tokens to version control)
- احفظ الرموز في `wp-config.php` ويجب أن يكون هذا الملف مستبعدًا من Git
- استخدم الرموز مع الأذونات المناسبة (مسؤول النظام للتكامل الكامل)
- حدد تواريخ انتهاء صلاحية الرموز للبيئات الإنتاجية
- قم بتدوير الرموز دوريًا

### الأداء
- استخدم فترة فحص DNS الافتراضية (300 ثانية) لتجنب مكالمات API مفرطة  
- راقب موارد خادم Enhance عند تشغيل عمليات نطاق كبيرة  
- اعتبر توزيع عمليات إضافة النطاقات إذا كنت تقوم بتعيين العديد من النطاقات دفعة واحدة

### المراقبة
- راقب سجلات Ultimate Multisite بانتظام للعثور على أخطاء التكامل  
- قم بإعداد مراقبة لإضافة النطاقات الفاشلة  
- تحقق من أن شهادات SSL تُوفر بشكل صحيح  
- راقب سعة خادم Enhance وحدود النطاق

## الموارد الإضافية

- **الوثائق الرسمية لـ Enhance:** [https://enhance.com/docs](https://enhance.com/docs)  
- **وثائق API لـ Enhance:** [https://apidocs.enhance.com](https://apidocs.enhance.com)  
- **منتدى مجتمع Enhance:** [https://community.enhance.com](https://community.enhance.com)  
- **مناقشة GitHub:** [المسألة #265 - نصائح تكامل Enhance](https://github.com/Multisite-Ultimate/ultimate-multisite/discussions/265)  
- **دليل تكوين تعيين النطاق لـ Ultimate Multisite:** راجع صفحة ويكي "كيفية تكوين تعيين النطاق v2"

## الدعم

إذا واجهت مشاكل:  
1. تحقق من قسم استكشاف الأخطاء وإصلاحها أعلاه  
2. راجع سجلات Ultimate Multisite  
3. استشر [مناقشات GitHub](https://github.com/Multisite-Ultimate/ultimate-multisite/discussions)  
4. اتصل بدعم Enhance للمشكلات الخاصة باللوحة  
5. أنشئ مناقشة جديدة مع سجلات خطأ مفصلة للمساعدة المجتمعية

## ملاحظات

- يتعامل هذا التكامل مع أسماء النطاقات المستعارة فقط؛ يدير Enhance SSL تلقائيًا  
- يدعم التكامل كل من تعيينات النطاق المخصصة والمواقع المعتمدة على النطاق الفرعي  
- يمكن تكوين إنشاء النطاق الفرعي www تلقائيًا في إعدادات تعيين النطاق  
- يدعم Enhance حاليًا تكوينات Apache (متاح LiteSpeed Enterprise)  
- إزالة النطاق من Ultimate Multisite سيزيل النطاق من Enhance ولكن قد لا يحذف شهادات SSL المرتبطة فورًا
