---
title: Мастер установки мультисайта
sidebar_position: 3
_i18n_hash: fd09dc94f24b0b37245b847380feea3f
---
# Мастер настройки Multisite

Ultimate Multisite включает встроенный мастер, который автоматически преобразует стандартную установку WordPress в сеть WordPress Multisite. Это устраняет необходимость вручную редактировать `wp-config.php` или выполнять команды базы данных.

:::tip
Если ваша установка WordPress уже работает как сеть Multisite, вы можете полностью пропустить этот шаг. Мастер появляется только тогда, когда Multisite еще не включен.
:::

## Когда появляется мастер?

Когда вы активируете Ultimate Multisite на стандартной (не Multisite) установке WordPress, плагин обнаруживает, что Multisite не включен, и автоматически перенаправляет вас к мастеру настройки Multisite вместо обычного мастера настройки.

Вы также можете получить к нему доступ напрямую через **WP Admin > Ultimate Multisite > Multisite Setup**.

## Предварительные требования

Перед запуском мастера убедитесь, что:

- У вас есть **административный доступ** к вашей установке WordPress
- Файл `wp-config.php` вашего сервера **доступен для записи** веб‑сервером
- У вас есть **недавняя резервная копия** ваших файлов и базы данных

:::warning
Мастер изменяет ваш файл `wp-config.php` и создает новые таблицы базы данных. Всегда создавайте резервную копию перед продолжением.
:::

## Шаг 1: Добро пожаловать

Первый экран объясняет, что такое WordPress Multisite и что сделает мастер:

- Включить функцию Multisite в вашей конфигурации WordPress
- Создать необходимые таблицы сети в базе данных
- Добавить необходимые константы Multisite в `wp-config.php`
- Сеть‑активировать Ultimate Multisite во всей сети

![Мастер настройки Multisite - шаг приветствия](/img/installation/multisite-wizard/wizard-welcome.png)

Нажмите **Continue**, чтобы продолжить.

## Шаг 2: Конфигурация сети

На этом шаге вам предлагается настроить параметры сети.

### Структура сайтов

Выберите, как будут организованы сайты вашей сети:

- **Поддомены** (рекомендуется) — Сайты получают собственный поддомен, например `site1.yourdomain.com`
- **Подкаталоги** — Сайты создаются как пути, например `yourdomain.com/site1`

:::note
Если вы выберете поддомены, вам понадобится настроить **wildcard DNS** и **wildcard SSL сертификат** для вашего домена. Большинство управляемых хостингов WordPress обрабатывают это автоматически. См. [Ultimate Multisite 101](./ultimate-multisite-101) для подробного сравнения.
:::

### Название сети

Введите название для вашей сети. По умолчанию используется текущий заголовок сайта с добавлением «Network». Вы можете изменить это позже в настройках сети.

### Электронная почта администратора сети

Адрес электронной почты, используемый для уведомлений о работе сети. По умолчанию это адрес текущего пользователя.

![Мастер настройки Multisite - Конфигурация сети](/img/installation/multisite-wizard/wizard-network-configuration.png)

После заполнения полей нажмите **Continue**, чтобы продолжить.

## Шаг 3: Установка

Нажмите кнопку **Install**, чтобы начать. Мастер выполняет пять автоматизированных шагов последовательно, каждый из которых показывает свой прогресс в реальном времени:

![Мастер настройки Multisite - Ожидание установки](/img/installation/multisite-wizard/wizard-installation-pending.png)

| Шаг | Описание |
|------|-------------|
| **Enable Multisite** | Добавляет константу `WP_ALLOW_MULTISITE` в `wp-config.php` |
| **Create Network** | Создает таблицы сети Multisite (`wp_site`, `wp_sitemeta`, `wp_blogs` и т.д.) и заполняет их вашей конфигурацией сети |
| **Update Configuration** | Добавляет окончательные константы Multisite в `wp-config.php` (`MULTISITE`, `SUBDOMAIN_INSTALL`, `DOMAIN_CURRENT_SITE` и т.д.) |
| **Fix Cookies** | Убедитесь, что URL сайта правильный в метаданных сети, чтобы предотвратить проблемы с аутентификацией после активации |
| **Network Activate Plugin** | Сеть‑активирует Ultimate Multisite, чтобы он работал во всей сети |

Каждый шаг отображает один из следующих статусов:

- **Pending** — Ожидание обработки
- **Installing...** — В настоящее время выполняется
- **Success!** — Успешно завершено
- **Error message** — Произошла ошибка (сообщение описывает проблему)

После успешного завершения всех шагов вы увидите зеленый статус «Success!» для каждого пункта:

![Мастер настройки Multisite - Завершение установки](/img/installation/multisite-wizard/wizard-installation-complete.png)

Мастер затем автоматически перейдет к экрану завершения.

## Шаг 4: Завершено

После завершения установки вы увидите сообщение об успехе, подтверждающее, что WordPress Multisite включен.

![Мастер настройки Multisite - Завершено](/img/installation/multisite-wizard/wizard-complete.png)

Теперь вы можете продолжить с мастером настройки Ultimate Multisite, чтобы настроить вашу платформу WaaS (детали компании, контент по умолчанию, платежные шлюзы и т.д.).

:::note
После завершения установки Multisite ваш браузер будет перенаправлен через недавно включенного администратора сети. Возможно, вам придется войти снова, поскольку куки аутентификации обновлены для среды Multisite.
:::

## Резервный ручной набор

Если мастер не может записать в ваш файл `wp-config.php` (из-за прав доступа к файлу или ограничений сервера), он отобразит точный код, который вам нужно добавить вручную:

1. Константы **wp-config.php**, которые необходимо добавить над строкой `/* That's all, stop editing! */`
2. Правила переписывания **.htaccess**, подходящие для выбранной вами структуры сайта (поддомен или подкаталог)

После внесения ручных изменений обновите страницу, и мастер обнаружит, что Multisite теперь активен.

## Устранение неполадок

### Мастер сообщает, что wp-config.php недоступен для записи

Процесс вашего веб‑сервера должен иметь разрешение на запись в файл `wp-config.php`. Вы можете:

- Временно изменить права доступа к файлу на `644` или `666`
- Использовать инструкции резервного ручного набора, предоставленные мастером
- Обратиться к вашему хостинг‑провайдеру за помощью

### Сайты недоступны после установки (поддомены)

Если вы выбрали структуру поддоменов, вам необходимо настроить **wildcard DNS** для вашего домена. Добавьте запись DNS:

```
Type: A (or CNAME)
Host: *
Value: [your server IP]
```

Проверьте у вашего хостинг‑провайдера, если вы не уверены, как это настроить.

### Проблемы с аутентификацией после установки

Если вы вышли из системы или испытываете ошибки с куки после настройки Multisite:

1. Очистите куки вашего браузера для сайта
2. Войдите снова на `yourdomain.com/wp-login.php`
3. Если проблема сохраняется, проверьте, что в вашем `wp-config.php` не установлено `COOKIE_DOMAIN` в `false` — это известная проблема при установке Multisite с поддоменами

### Шаг не выполнен во время установки

Если один из шагов установки показывает ошибку:

1. Запишите отображаемое сообщение об ошибке
2. Вернитесь к шагу конфигурации и попробуйте снова
3. Если ошибка сохраняется, проверьте журнал ошибок PHP вашего сервера для более подробной информации
4. Шаги, которые уже завершены, будут пропущены при последующих запусках (установщик идемпотентен)
